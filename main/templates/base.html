{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .logo { 
        max-height: 38px; 
        width: auto; 
        border-radius: 10px;
      }
    </style>
  </head>

  <body class="min-h-screen bg-white text-[#0B1B34] pt-16">
    <nav class="fixed top-0 left-0 w-full bg-[#0B1F3A] text-white shadow-md z-50">
      <div class="max-w-7xl mx-auto px-6 lg:px-8">
<div class="relative flex h-16 items-center justify-center">
  <a href="{% url 'main:show_main' %}" class="absolute left-0 inline-flex items-center">
    <img src="{% static 'img/ballershaven.png' %}" class="logo" alt="Baller's Haven logo" />
  </a>

  <ul class="hidden md:flex items-center gap-3">
    <li>
      <a href="{% url 'main:show_main' %}"
         class="px-3 py-1.5 rounded-lg hover:bg-white/10 transition">
        Home
      </a>
    </li>
    {% if user.is_authenticated %}
    <li>
      <button type="button" id="navAddProductBtn"
         class="px-3 py-1.5 rounded-lg hover:bg-white/10 transition focus:outline-none">
        Add Product
      </button>
    </li>
    {% endif %}

    {% with current=request.GET.category|default_if_none:'' %}
    <li class="relative">
      <button id="ddCatBtn"
              class="inline-flex items-center px-3 py-1.5 rounded-lg hover:bg-white/10 transition focus:outline-none">
        Categories
        <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
      </button>

      <ul id="ddCatMenu"
          class="absolute left-1/2 -translate-x-1/2 mt-2 w-48 bg-white text-[#0B1F3A]
                 rounded-lg shadow-lg border border-gray-200 hidden z-50 overflow-hidden">
        <button type="button" data-category="" class="block w-full px-3 py-2 text-left hover:bg-gray-100">All</button>
        <button type="button" data-category="merchandise" class="block w-full px-3 py-2 text-left hover:bg-gray-100">Merchandise</button>
        <button type="button" data-category="accessories" class="block w-full px-3 py-2 text-left hover:bg-gray-100">Accessories</button>
        <button type="button" data-category="shoe" class="block w-full px-3 py-2 text-left hover:bg-gray-100">Shoe</button>
        <button type="button" data-category="jersey" class="block w-full px-3 py-2 text-left hover:bg-gray-100">Jersey</button>
        <button type="button" data-category="ball" class="block w-full px-3 py-2 text-left hover:bg-gray-100">Ball</button>
        <button type="button" data-category="player" class="block w-full px-3 py-2 text-left hover:bg-gray-100">Player</button>
      </ul>
    </li>
    {% endwith %}
  </ul>


  <div class="absolute right-0 hidden md:flex items-center space-x-6">
    {% if user.is_authenticated %}
      <div class="text-right">
        <div class="text-sm font-semibold">{{ user.username }}</div>
        <div class="text-xs text-white/70">Logged in</div>
      </div>
      <button type="button" id="logoutButton" data-logout-url="{% url 'main:logout' %}"
         class="bg-white text-[#0B1F3A] px-4 py-2 rounded-full text-sm font-semibold hover:opacity-90 transition focus:outline-none">
        Logout
      </button>
    {% else %}
      <a href="{% url 'main:login' %}"
         class="px-4 py-2 rounded-full text-sm font-semibold bg-white/10 hover:bg-white/20 transition">
         Login
      </a>
      <a href="{% url 'main:register' %}"
         class="bg-white text-[#0B1F3A] px-4 py-2 rounded-full text-sm font-semibold hover:opacity-90 transition">
         Register
      </a>
    {% endif %}
  </div>

  <div class="md:hidden absolute right-0 flex items-center">
    <button class="p-2 text-white/90 hover:text-white transition"
            aria-label="Open menu" aria-controls="mobileMenu"
            onclick="document.getElementById('mobileMenu').classList.toggle('hidden')">
      <div class="w-6 h-6 flex flex-col justify-center items-center">
        <span class="bg-current block h-0.5 w-6 rounded-sm"></span>
        <span class="bg-current block h-0.5 w-6 rounded-sm my-0.5"></span>
        <span class="bg-current block h-0.5 w-6 rounded-sm"></span>
      </div>
    </button>
  </div>
</div>


      </div>
    </nav>

    <main class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8">
      {% block content %}{% endblock content %}
    </main>

    <footer class="mt-12 border-t border-[#0B1B34]/10 bg-white">
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8 flex flex-col sm:flex-row items-center justify-between gap-4">
        <p class="text-sm text-[#0B1B34]/70">&copy; {{ now|default:2025 }} Baller's Haven. All rights reserved.</p>
        <p class="text-sm text-[#0B1B34]/70">Crafted for the beautiful game.</p>
      </div>
    </footer>

    <div id="toast-container" class="fixed top-20 right-6 flex flex-col gap-3 z-[60] pointer-events-none"></div>

    <script>
      (function () {
        document.addEventListener('click', function (e) {
          const btn = document.getElementById('ddCatBtn');
          const menu = document.getElementById('ddCatMenu');
          if (!btn || !menu) return;
          if (btn.contains(e.target)) {
            menu.classList.toggle('hidden');
          } else if (!menu.contains(e.target)) {
            menu.classList.add('hidden');
          }
        });
      })();

      window.appUtils = (function () {
        function getCookie(name) {
          const cookieValue = document.cookie
            .split('; ')
            .find((row) => row.startsWith(name + '='));
          return cookieValue ? decodeURIComponent(cookieValue.split('=')[1]) : null;
        }

        function showToast(message, variant = 'info') {
          const container = document.getElementById('toast-container');
          if (!container) return;

          const baseStyles = 'pointer-events-auto flex items-start gap-3 rounded-xl border px-4 py-3 shadow-lg text-sm transition-opacity duration-300';
          const variants = {
            success: 'bg-green-50 border-green-200 text-green-800',
            error: 'bg-red-50 border-red-200 text-red-700',
            info: 'bg-blue-50 border-blue-200 text-blue-700',
            warning: 'bg-amber-50 border-amber-200 text-amber-700',
          };
          const toast = document.createElement('div');
          toast.className = `${baseStyles} ${variants[variant] || variants.info}`;
          toast.classList.add('opacity-0');
          toast.innerHTML = `
            <div class="flex-1 leading-relaxed">${message}</div>
            <button type="button" class="text-current/70 hover:text-current font-semibold focus:outline-none">Ã—</button>
          `;

          const dismiss = () => {
            toast.classList.add('opacity-0');
            setTimeout(() => toast.remove(), 250);
          };

          toast.querySelector('button')?.addEventListener('click', dismiss);
          setTimeout(dismiss, 3200);
          container.appendChild(toast);
          requestAnimationFrame(() => toast.classList.remove('opacity-0'));
        }

        function toggleBodyScroll(disabled) {
          document.body.classList.toggle('overflow-hidden', Boolean(disabled));
        }

        return { getCookie, showToast, toggleBodyScroll };
      })();
    </script>
    <script defer src="{% static 'js/auth.js' %}"></script>
    <script defer src="{% static 'js/products.js' %}"></script>

  </body>
</html>
